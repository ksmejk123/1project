from urllib.parse import urlencode
from urllib.request import urlopen,Request
import json

u_key = 'insert key'
#유치원 이름 원생수
url = 'http://e-childschoolinfo.moe.go.kr/api/notice/basicInfo.do'
url2 = 'http://e-childschoolinfo.moe.go.kr/api/notice/teachersInfo.do'
p_page = '100'
c_page = '1'

si_list = ['11','26','27','28','29','30','31','36','41','42','43','44','45','46','47','48','50']
seoul = ['11110','11140','11170','11200','11215','11230','11260','11290','11305','11320','11350','11380','11410','11440','11470','11500','11530','11545','11560','11590','11620','11650','11680','11710','11740']
busan = ['26110','26140','26170','26200','26230','26260','26290','26320','26350','26380','26410','26440','26470','26500','26530','26710']
daegu = ['27110','27140','27170','27200','27230','27290','27290','27710']
incheon = ['28110','28140','28170','28185','28200','28237','28245','28260','28710','28720']
gwangju = ['29110','29140','29155','29170','29200']
daejeon = ['30110','30140','30170','30200','30230']
ulsan = ['31110','31140','31170','31200','31710']
sejong = ['36110']
#경기도
gg = ['41110','41111','41113','41115','41117','41130','41131','41133','41135','41150','41170','41171','41173','41190','41195','41197','41199','41210','41220','41250','41270','41271','41273','41280','41281','41285','41287','41290','41310','41360','41370','41390','41410','41430','41450','41460','41461','41463','41465','41480','41500','41550','41570','41590','41610','41630','41650','41730','41800','41820','41830']
gangwon = ['42110','42130','42150','42170','42190','42210','42230','42720','42730','42750','42760','42770','42780','42790','42800','42810','42820','42830']
chung_buk = ['43110','43111','43113','43130','43150','43710','43720','43730','43740','43745','43750','43760','43770','43800']
chung_nam = ['44130','44131','44133','44150','44180','44200','44210','44230','44250','44710','44730','44760','44770','44790','44800','44810','44825','44830']
jeon_buk = ['45110','45111','45113','45130','45140','45180','45190','45210','45710','45720','45730','45740','45750','45770','45790','45800']
jeon_nam = ['46110','46130','46150','46170','46230','46710','46720','46730','46770','46780','46790','46800','46810','46820','46830','46840','46860','46870','46880','46890','46900','46910']
g_buk = ['47110','47111','47113','47130','47150','47170','47190','47210','47230','47250','47280','47290','47720','47730','47750','47760','47770','47820','47830','47840','47850','47900','47920','47930','47940']
g_nam = ['48120','48125','48127','48123','48121','48129','48170','48220','48240','48250','48270','48310','48330','48720','48730','48740','48820','48840','48850','48860','48870','48880','48890']
jeju = ['50110','50130']

#시도 코드
si_code = '11'
#시군구 코드
sg_code = '11140'


def date_get(si,sg):
    params = urlencode({
        'key' : u_key,
        'pageCnt' : p_page,
        'currentPage' : c_page,
        'sidoCode' : si_code,
        'sggCode' : sg_code
    })

    params = params.encode('utf-8')
    # req = Request(url, data=params)
    f = urlopen(url,params)
    date = f.read().decode('utf-8')
    json_date = json.loads(date)
    info = json_date['kinderInfo']
    rd = re_Date(info)

    return  rd

def re_Date(info_date):
    re_date = []
    for x in info_date:
        name = x['kindername']
        p3 = x['ppcnt3']
        p4 = x['ppcnt4']
        p5 = x['ppcnt5']
        mp = x['mixppcnt']
        sp = x['shppcnt']
        # dic = {'name':name,'p3':p3,'p4':p4,'p5':p5,'mp':mp,'sp':sp}
        list = [p3,p4,p5,mp,sp]
        total = 0
        for x in list:
            if x == None:
                x = 0
            total = total + int(x)
        print(total)
        dic2 = {'name':name,'total':total}
        re_date.append(dic2)
    return re_date
if __name__ == '__main__':
    a = date_get('11','11110')
    print(a)



